# Troubleshooting Guide

## Ошибка: "Ошибка парсинга ответа от ИИ: Expecting value: line 1 column 1 (char 0)"

Эта ошибка означает, что Mistral AI API возвращает пустой ответ или ответ, который не является валидным JSON.

### Возможные причины:

1. **API ключ не настроен**
2. **Неправильный API ключ**
3. **Проблемы с подключением к интернету**
4. **Превышен лимит запросов**
5. **Проблемы с сервисом Mistral AI**

### Решение:

#### Шаг 1: Настройка API ключа

1. Получите API ключ на https://console.mistral.ai/
2. Запустите скрипт настройки:
   ```bash
   cd api
   python setup_env.py setup
   ```
3. Введите ваш API ключ когда будет запрошено

#### Шаг 2: Проверка настроек

Проверьте текущие настройки:

```bash
python setup_env.py check
```

#### Шаг 3: Тестирование подключения

Запустите тест подключения:

```bash
python test_mistral.py
```

#### Шаг 4: Запуск сервера

Если все тесты пройдены, запустите сервер:

```bash
cd src
python manage.py runserver
```

### Альтернативное решение:

Если у вас нет API ключа или есть проблемы с Mistral AI, система автоматически использует заглушку (stub generator), которая создает базовые квесты без использования внешнего API.

### Дополнительная отладка:

1. **Проверьте логи сервера** - они покажут детальную информацию об ошибках
2. **Проверьте .env файл** - убедитесь, что API ключ правильно установлен
3. **Проверьте подключение к интернету** - API требует стабильное соединение

### Структура .env файла:

```env
# Mistral AI API Configuration
MISTRAL_API_KEY=your_actual_api_key_here

# Django Settings
DEBUG=True
SECRET_KEY=your_django_secret_key

# Database
DATABASE_URL=sqlite:///db.sqlite3

# Optional: Model configuration
MISTRAL_MODEL=mistral-large-latest
```

### Если проблема остается:

1. Проверьте, что у вас есть действующий API ключ
2. Убедитесь, что у вас есть кредиты на аккаунте Mistral AI
3. Попробуйте использовать другой API ключ
4. Обратитесь в поддержку Mistral AI

### Логи для отладки:

Система теперь предоставляет подробные логи:

- Информация о настройке API клиента
- Детали запросов к API
- Полные ответы от API
- Ошибки парсинга JSON
- Информация о валидации квестов
